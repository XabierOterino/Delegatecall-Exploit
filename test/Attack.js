const {ethers} = require("hardhat")
const {expect} = require("chai")

describe("Attack" , () => {
    let a, c
    let delegator
    beforeEach(async () => {
        const C = await ethers.getContractFactory('C')
        c = await C.deploy()
        await c.deployed()

        const B = await ethers.getContractFactory('B')
        const b = await B.deploy(c.address)
        await B.deployed()
        delegator = b.address

        const A = await ethers.getContractFactory('A')
        a = await A.deploy()
        await a.deployed()
    })

    it("Should change C's owner to A", async()=>{
        await (await a.attack(delegator)).wait()
        const newOwner = await c.owner()
        expect(newOwner).to.equal(a.address)
    })


})